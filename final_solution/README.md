# Financial Forecasting Solution
## HSE Finam Hackathon

Production-ready —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π –∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Ä–æ—Å—Ç–∞ –∞–∫—Ü–∏–π –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞—Ö 1 –∏ 20 –¥–Ω–µ–π.

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ä–µ—à–µ–Ω–∏—è)
- [–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö](#—Ñ–æ—Ä–º–∞—Ç-–¥–∞–Ω–Ω—ã—Ö)
- [API Documentation](#api-documentation)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏](#—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-–¥–µ—Ç–∞–ª–∏)
- [–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è](#–ø—Ä–∏–º–µ—Ä—ã-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install pandas numpy scikit-learn lightgbm catboost
```

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from solution import FinancialForecaster

# 1. –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
model = FinancialForecaster(random_state=42)
model.fit(
    candles_path='train_candles.csv',
    news_path='train_news.csv'
)

# 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
model.save('trained_model.pkl')

# 3. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
submission = model.predict(
    candles_path='test_candles.csv',
    news_path='test_news.csv',
    output_path='submission.csv'
)
```

### –ó–∞–ø—É—Å–∫ demo

```bash
cd final_solution
jupyter notebook demo.ipynb
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

```
final_solution/
‚îú‚îÄ‚îÄ solution.py          # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å FinancialForecaster
‚îú‚îÄ‚îÄ demo.ipynb           # Jupyter –Ω–æ—É—Ç–±—É–∫ —Å –ø—Ä–∏–º–µ—Ä–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ README.md            # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ trained_model.pkl    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (—Å–æ–∑–¥–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ fit)
```

---

## üìä –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

### –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (train)

#### 1. **candles.csv** - OHLCV –¥–∞–Ω–Ω—ã–µ

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| ticker  | str | –¢–∏–∫–µ—Ä –∞–∫—Ü–∏–∏ (AFLT, GAZP, ...) |
| begin   | str | –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ —Å–≤–µ—á–∏ (YYYY-MM-DD) |
| open    | float | –¶–µ–Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è |
| high    | float | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ |
| low     | float | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ |
| close   | float | –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è |
| volume  | int | –û–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤ |

**–ü—Ä–∏–º–µ—Ä:**
```csv
ticker,begin,open,high,low,close,volume
AFLT,2020-06-19,52.5,53.2,52.1,52.8,1000000
AFLT,2020-06-22,52.8,54.0,52.5,53.5,1200000
GAZP,2020-06-19,180.0,182.5,179.0,181.2,5000000
```

#### 2. **news.csv** - –ù–æ–≤–æ—Å—Ç–∏

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| publish_date | str | –î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ (YYYY-MM-DD) |
| title | str | –ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏ |
| publication | str | –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ |

**–ü—Ä–∏–º–µ—Ä:**
```csv
publish_date,title,publication
2020-06-19,"–†–æ—Å—Ç –∞–∫—Ü–∏–π –ê—ç—Ä–æ—Ñ–ª–æ—Ç–∞","–ê–∫—Ü–∏–∏ –∫–æ–º–ø–∞–Ω–∏–∏ –ø–æ–∫–∞–∑–∞–ª–∏ —Ä–æ—Å—Ç –Ω–∞ —Ñ–æ–Ω–µ..."
2020-06-19,"–ì–∞–∑–ø—Ä–æ–º —É–≤–µ–ª–∏—á–∏–ª –ø—Ä–∏–±—ã–ª—å","–ö–æ–º–ø–∞–Ω–∏—è –æ—Ç—á–∏—Ç–∞–ª–∞—Å—å –æ —Ä–æ—Å—Ç–µ –ø—Ä–∏–±—ã–ª–∏..."
```

### –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (submission)

#### **submission.csv** - –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è

| –ö–æ–ª–æ–Ω–∫–∞ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|-----|----------|
| ticker | str | –¢–∏–∫–µ—Ä –∞–∫—Ü–∏–∏ |
| date | str | –î–∞—Ç–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (YYYY-MM-DD) |
| return_1d | float | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –Ω–∞ 1 –¥–µ–Ω—å |
| return_20d | float | –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –Ω–∞ 20 –¥–Ω–µ–π |
| prob_1d | float | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–æ—Å—Ç–∞ –Ω–∞ 1 –¥–µ–Ω—å [0-1] |
| prob_20d | float | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ä–æ—Å—Ç–∞ –Ω–∞ 20 –¥–Ω–µ–π [0-1] |

**–ü—Ä–∏–º–µ—Ä:**
```csv
ticker,date,return_1d,return_20d,prob_1d,prob_20d
AFLT,2024-09-09,-0.029472,0.058811,0.001950,0.998163
AFLT,2024-09-10,-0.020521,0.090201,0.001932,0.998104
```

---

## üîß API Documentation

### Class: `FinancialForecaster`

–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π.

#### `__init__(self, random_state: int = 42)`

–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `random_state` (int): Random seed –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**–ü—Ä–∏–º–µ—Ä:**
```python
model = FinancialForecaster(random_state=42)
```

---

#### `fit(self, candles_path: str, news_path: str)`

–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `candles_path` (str): –ü—É—Ç—å –∫ CSV —Ñ–∞–π–ª—É —Å OHLCV –¥–∞–Ω–Ω—ã–º–∏
- `news_path` (str): –ü—É—Ç—å –∫ CSV —Ñ–∞–π–ª—É —Å –Ω–æ–≤–æ—Å—Ç—è–º–∏

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** None

**–≠—Ç–∞–ø—ã –æ–±—É—á–µ–Ω–∏—è:**
1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π (sentiment analysis)
3. Feature engineering (100+ —Ñ–∏—á)
4. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —Ç–∏–∫–µ—Ä–æ–≤
5. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
6. –û–±—É—á–µ–Ω–∏–µ –∞–Ω—Å–∞–º–±–ª—è –º–æ–¥–µ–ª–µ–π

**–ü—Ä–∏–º–µ—Ä:**
```python
model.fit(
    candles_path='data/train_candles.csv',
    news_path='data/train_news.csv'
)
```

---

#### `predict(self, candles_path: str, news_path: str, output_path: str = 'submission.csv') -> pd.DataFrame`

–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ submission —Ñ–∞–π–ª–∞.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `candles_path` (str): –ü—É—Ç—å –∫ CSV —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ OHLCV –¥–∞–Ω–Ω—ã–º–∏
- `news_path` (str): –ü—É—Ç—å –∫ CSV —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –Ω–æ–≤–æ—Å—Ç—è–º–∏
- `output_path` (str): –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è submission (default: 'submission.csv')

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `pd.DataFrame` —Å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏

**–≠—Ç–∞–ø—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:**
1. –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–æ–≤–æ—Å—Ç–µ–π
3. Feature engineering
4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
6. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ submission

**–ü—Ä–∏–º–µ—Ä:**
```python
submission = model.predict(
    candles_path='data/test_candles.csv',
    news_path='data/test_news.csv',
    output_path='my_submission.csv'
)

print(submission.head())
```

---

#### `save(self, path: str)`

–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `path` (str): –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è '.pkl' —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)

**–°–æ—Ö—Ä–∞–Ω—è–µ—Ç:**
- –û–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
- Scalers
- Feature lists
- Ticker clusters
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–µ–π

**–ü—Ä–∏–º–µ—Ä:**
```python
model.save('trained_model.pkl')
```

---

#### `load(self, path: str)`

–ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `path` (str): –ü—É—Ç—å –∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏

**–ü—Ä–∏–º–µ—Ä:**
```python
model = FinancialForecaster()
model.load('trained_model.pkl')

# –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –±–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
submission = model.predict(...)
```

---

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

#### 1. **News Processing**
- **Sentiment Analysis**: Keyword-based –ø–æ–¥—Ö–æ–¥ —Å 56 –∫–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ (28 –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö + 28 –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö)
- **Market-level –∞–≥—Ä–µ–≥–∞—Ü–∏—è**: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –æ–∫–Ω–∞–º 1/3/7/14/30 –¥–Ω–µ–π
- **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Ñ–∏—á–∏**: –°–¥–≤–∏–≥–∏ sentiment, news bursts, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–π
- **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ**: –°–≤–µ–∂–∏–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏–º–µ—é—Ç –±–æ–ª—å—à–∏–π –≤–µ—Å (decay_rate=0.1)
- **1-day lag**: –ù–æ–≤–æ—Å—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –¥–µ–Ω—å
- **Interaction features**: Sentiment √ó Returns, News √ó Volatility

**–í—Å–µ–≥–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è ~50 –Ω–æ–≤–æ—Å—Ç–Ω—ã—Ö —Ñ–∏—á**

#### 2. **Price Features**
- Returns –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞—Ö: 1, 2, 5, 10, 20, 60 –¥–Ω–µ–π
- –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: Realized vol, High-Low spread, Parkinson volatility
- Momentum: SMA (5/10/20/60), Price-to-SMA ratios
- Mean Reversion: Momentum ratios
- RSI (14, 30)
- Volume: MA, Std, Relative volume, Z-score, Volume-Price correlation
- Market-level: Cross-sectional –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –∏ —Ä–∞–Ω–≥–∏
- Beta –∫ —Ä—ã–Ω–∫—É (20, 60 –¥–Ω–µ–π)
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ: Day of week (sin/cos), Month

**–í—Å–µ–≥–æ —Å–æ–∑–¥–∞–µ—Ç—Å—è ~70 —Ü–µ–Ω–æ–≤—ã—Ö —Ñ–∏—á**

#### 3. **Ticker Clustering**
- **–¶–µ–ª—å**: –ì–µ–Ω–µ—Ä–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ –Ω–æ–≤—ã–µ (–Ω–µ–≤–∏–¥–µ–Ω–Ω—ã–µ) —Ç–∏–∫–µ—Ä—ã
- **–ú–µ—Ç–æ–¥**: K-Means –Ω–∞ 5 —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞—Ö (mean_return, std_return, vol, volume, beta)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: 4 –∫–ª–∞—Å—Ç–µ—Ä–∞ —Ç–∏–∫–µ—Ä–æ–≤

#### 4. **Models Ensemble**

| –ú–æ–¥–µ–ª—å | –ó–∞–¥–∞—á–∞ | –§–∏—á–∏ | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã |
|--------|--------|------|-----------|
| LGBM (1d) | Regression: return_1d | Tree features (100+) | n_est=200, lr=0.05, depth=5 |
| LGBM (20d) | Regression: return_20d | Tree features (100+) | n_est=300, lr=0.03, depth=6 |
| CatBoost (prob 1d) | Classification: P(return_1d > 0) | Tree features (100+) | iter=100, lr=0.03, depth=5 |
| CatBoost (prob 20d) | Classification: P(return_20d > 0) | Tree features (100+) | iter=100, lr=0.03, depth=5 |
| Ridge (1d) | Regression: return_1d | Macro features (40+) | alpha=1.0 |
| Ridge (20d) | Regression: return_20d | Macro features (40+) | alpha=1.0 |

**Ensemble weights**:
- `return_1d = 0.7 * LGBM + 0.3 * Ridge`
- `return_20d = 0.7 * LGBM + 0.3 * Ridge`
- `prob_1d = CatBoost (direct probability)`
- `prob_20d = CatBoost (direct probability)`

### –ü–æ—á–µ–º—É –¥–≤–∞ –Ω–∞–±–æ—Ä–∞ —Ñ–∏—á?

#### **Tree Features** (–¥–ª—è LGBM/CatBoost)
- –í—Å–µ —Ñ–∏—á–∏: —Ü–µ–Ω–æ–≤—ã–µ + –Ω–æ–≤–æ—Å—Ç–Ω—ã–µ + –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ (~120 —Ñ–∏—á)
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è gradient boosting –º–æ–¥–µ–ª–µ–π
- –ú–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ticker-specific –ø–∞—Ç—Ç–µ—Ä–Ω—ã

#### **Macro Features** (–¥–ª—è Ridge)
- –¢–æ–ª—å–∫–æ market-level —Ñ–∏—á–∏: market –∞–≥—Ä–µ–≥–∞—Ü–∏–∏, —Ä–∞–Ω–≥–∏, beta, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ, –Ω–æ–≤–æ—Å—Ç–Ω—ã–µ (~50 —Ñ–∏—á)
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ª–∏–Ω–µ–π–Ω–æ–π –º–æ–¥–µ–ª–∏
- –õ—É—á—à–µ –≥–µ–Ω–µ—Ä–∞–ª–∏–∑—É—é—Ç –Ω–∞ –Ω–æ–≤—ã–µ —Ç–∏–∫–µ—Ä—ã (On scenario)

---

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤—ã–π pipeline

```python
from solution import FinancialForecaster

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
model = FinancialForecaster(random_state=42)

# –û–±—É—á–µ–Ω–∏–µ
model.fit(
    candles_path='../forecast_data/candles.csv',
    news_path='../forecast_data/news.csv'
)

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
submission = model.predict(
    candles_path='../forecast_data/candles_2.csv',
    news_path='../forecast_data/news_2.csv',
    output_path='submission.csv'
)

print(f"–°–æ–∑–¥–∞–Ω submission —Å {len(submission)} —Å—Ç—Ä–æ–∫–∞–º–∏")
```

### –ü—Ä–∏–º–µ—Ä 2: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏

```python
from solution import FinancialForecaster

# –û–±—É—á–∞–µ–º –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º
model = FinancialForecaster()
model.fit('train_candles.csv', 'train_news.csv')
model.save('my_trained_model.pkl')

# –ü–æ–∑–∂–µ... –∑–∞–≥—Ä—É–∂–∞–µ–º –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ–º
loaded_model = FinancialForecaster()
loaded_model.load('my_trained_model.pkl')

submission = loaded_model.predict(
    'test_candles.csv',
    'test_news.csv',
    'submission.csv'
)
```

### –ü—Ä–∏–º–µ—Ä 3: –†–∞–±–æ—Ç–∞ —Å —Ä–∞–∑–Ω—ã–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö

```python
model = FinancialForecaster()

# –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –æ–¥–Ω–æ–º –Ω–∞–±–æ—Ä–µ –∫–æ–º–ø–∞–Ω–∏–π
model.fit(
    candles_path='data/companies_set_1_candles.csv',
    news_path='data/companies_set_1_news.csv'
)

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–æ–º –Ω–∞–±–æ—Ä–µ –∫–æ–º–ø–∞–Ω–∏–π
# (–º–æ–¥–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –¥–ª—è –≥–µ–Ω–µ—Ä–∞–ª–∏–∑–∞—Ü–∏–∏)
submission = model.predict(
    candles_path='data/companies_set_2_candles.csv',
    news_path='data/companies_set_2_news.csv',
    output_path='predictions_set_2.csv'
)
```

### –ü—Ä–∏–º–µ—Ä 4: –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```python
import pandas as pd

# –ó–∞–≥—Ä—É–∂–∞–µ–º submission
submission = pd.read_csv('submission.csv')

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–∏–∫–µ—Ä–∞–º
print("–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –ø–æ —Ç–∏–∫–µ—Ä–∞–º:")
print(submission.groupby('ticker').agg({
    'return_1d': ['mean', 'std'],
    'return_20d': ['mean', 'std'],
    'prob_1d': 'mean',
    'prob_20d': 'mean'
}))

# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
print("\n–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π:")
print(submission[['prob_1d', 'prob_20d']].describe())

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
print("\n–¢–æ–ø-5 –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Ä–æ—Å—Ç–∞ –Ω–∞ 20 –¥–Ω–µ–π:")
print(submission.nlargest(5, 'return_20d')[['ticker', 'date', 'return_20d', 'prob_20d']])
```

---

## üí° –°–æ–≤–µ—Ç—ã –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –î–ª—è –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞:

1. **–ë–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–ª–∏–Ω–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é (–º–∏–Ω–∏–º—É–º 1 –≥–æ–¥)
2. **–ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏**: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–æ–≤–æ—Å—Ç–∏ –ø–æ–∫—Ä—ã–≤–∞—é—Ç –ø–µ—Ä–∏–æ–¥ –æ–±—É—á–µ–Ω–∏—è
3. **–ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ –ø—Ä–æ–ø—É—Å–∫–∏ –∏ –∞–Ω–æ–º–∞–ª–∏–∏ –≤ OHLCV
4. **–ö—Ä–æ—Å—Å–≤–∞–ª–∏–¥–∞—Ü–∏—è**: –î–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ temporal split

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:

- **–ì–æ—Ä–∏–∑–æ–Ω—Ç—ã**: –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ 1 –∏ 20 –¥–Ω–µ–π, –¥–ª—è –¥—Ä—É–≥–∏—Ö –≥–æ—Ä–∏–∑–æ–Ω—Ç–æ–≤ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
- **Sentiment**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–π keyword-based –ø–æ–¥—Ö–æ–¥ (–º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å —á–µ—Ä–µ–∑ FinBERT/GPT)
- **–í—ã—á–∏—Å–ª–µ–Ω–∏—è**: Feature engineering –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç –Ω–∞ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üéØ Performance

–ù–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö (HSE Finam Hackathon):

| –ú–µ—Ç—Ä–∏–∫–∞ | 1d horizon | 20d horizon |
|---------|------------|-------------|
| MAE | ~0.02 | ~0.08 |
| Directional Accuracy | ~52% | ~58% |
| Brier Score (prob) | ~0.20 | ~0.15 |

*–ú–µ—Ç—Ä–∏–∫–∏ —É—Å—Ä–µ–¥–Ω–µ–Ω—ã –ø–æ O19 –∏ On —Å—Ü–µ–Ω–∞—Ä–∏—è–º*

---

## üìß Support

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `demo.ipynb` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

---

## üìÑ License

–†–µ—à–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ –¥–ª—è HSE Finam Hackathon.

---

**–ê–≤—Ç–æ—Ä:** Financial Forecasting Team
**–î–∞—Ç–∞:** 2025
**–í–µ—Ä—Å–∏—è:** 1.0
